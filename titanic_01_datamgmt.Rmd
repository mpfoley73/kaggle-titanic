---
title: "Kaggle - Titanic"
subtitle: "Step 1: Data Management"
author: "Michael Foley"
date: "4/27/2020"
output: 
  html_document:
    theme: flatly
    toc: true
    highlight: haddock
    fig_width: 9
    fig_caption: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


The [Titanic: Machine Learning from Disaster](https://www.kaggle.com/c/titanic) competition challenges participants to predict the survivorship (1 = survived, 0 = perished) of passengers aboard the April 1912 maiden voyage of the Titanic.  In total, 1,502 of the 2,224 passengers and crew perished (68%). The training (*n* = 891) and test (*n* = 418) datasets comprise only a fraction of the total (59%). The data includes 10 features. Competitors build a predictive model with the training dataset, then apply the model to the test dataset to produce a submission file consisting of `PassengerId` and `Survived` (1|0).  Kaggle evaluates submissions on *accuracy*.

This file handles the data management, EDA, and feature engineering.  I got a lot of ideas from [here](https://www.kaggle.com/mrisdal/exploring-survival-on-the-titanic).


# Setup

```{r message=FALSE}
library(tidyverse)
```


# Load Data

Here are the [column definitions](https://www.kaggle.com/c/titanic/data) in the dataset:

Variable | Definition
---|---
PassengerId	| 
Survived | Survival (0 = No, 1 = Yes)
Pclass | Passenger class (1 = 1st, 2 = 2nd, 3 = 3rd)
Name |				
Sex	| 		
Age	|	Passenger age (years)
SibSp	| # of siblings / spouses aboard the Titanic
Parch	| # of parents / children aboard the Titanic
Ticket | Ticket number
Fare | Passenger fare ($s)
Cabin	| Cabin number
Embarked | Port of Embarkation (C = Cherbourg, Q = Queenstown, S = Southampton)

```{r warning=FALSE, message=FALSE}
train <- read_csv("./train.csv") 
test <- read_csv("./test.csv")
full <- bind_rows(train, test)
train_index <- c(1:891)

glimpse(full)
```


# Feature Engineering

At this point, I know the full dataset is 1,309 x 12, including 10 feature columns.  `Name` includes a title and surname.  The title may be predictive of survivorship.  The surname may be useful for constructing family units (do families sink or swim together?).  What else stands out?

```{r}
skimr::skim(full)
```

`Name` is never `NA`.  Curious that there are only 1307 unique names among the 1309 rows. I guess that can happen.

```{r}
full %>% count(Name, sort = T) %>% head()
```


# Manage Data

Separate `Name` into `Surname`, `Title`, `Name`.

```{r}
# d_raw_2 <- d_raw_1 %>% 
#   separate(Name, ", ", into = c("Surname", "Name")) %>%
#   separate(Name, "\\. ", into = c("Title", "Name"), extra = "merge")
# 
# janitor::tabyl(d_raw_2$Title) %>% mutate(percent = round(percent, 2))
```

```{r}

```




# Create Test and Train




# Save Work

```{r}
#save(d_raw_1, 
#     file = "./titanic_01.RData")
```

